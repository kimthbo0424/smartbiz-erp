<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
      th:replace="~{base :: layout(~{::section})}">
<body>
<section>

  <div class="d-flex align-items-center mb-3">
    <h2 class="fw-bold mb-0 me-auto">급여 산정 등록</h2>
	<a th:href="@{/payroll}" class="btn btn-outline-secondary btn-sm">목록으로</a>
  </div>

  <div class="card shadow-sm border-0">
    <div class="card-body p-4" style="max-width: 720px;">

      <form th:action="@{/payroll/save}" method="post">

        <div class="mb-3">
          <label class="form-label mb-1">직원</label>
          <select class="form-select" name="employeeId" required>
            <option value="">직원 선택</option>
            <option th:each="e : ${employees}"
                    th:value="${e.employeeId}"
                    th:text="${e.employeeId} + ' ' + ${e.name}">
            </option>
          </select>
        </div>

        <div class="row g-2 mb-3">
          <div class="col-md-6">
            <label class="form-label mb-1">연도</label>
            <select class="form-select" name="year" required>
              <option value="">연도 선택</option>
              <option th:each="y : ${years}"
                      th:value="${y}"
                      th:text="${y}">
              </option>
            </select>
          </div>
          <div class="col-md-6">
            <label class="form-label mb-1">월</label>
            <select class="form-select" name="month" required>
              <option value="">월 선택</option>
              <option th:each="m : ${months}"
                      th:value="${m}"
                      th:text="${m}">
              </option>
            </select>
          </div>
        </div>

		<div class="mb-3">
		  <div class="fw-bold mb-2">급여 항목 선택</div>

		  <div class="table-responsive" style="max-height:240px;">
		    <table class="table table-sm align-middle mb-0">
		      <thead class="table-light">
		      <tr>
		        <th style="width:60px;">선택</th>
		        <th>항목</th>
		        <th>유형</th>
		        <th>계산</th>
		        <th class="text-end">고정금액</th>
		        <th class="text-end">비율</th>
		      </tr>
		      </thead>
		      <tbody>
		      <tr th:each="it : ${items}">
		        <td>
		          <input class="form-check-input"
		                 type="checkbox"
		                 name="itemIds"
		                 th:value="${it.itemId}">
		        </td>
		        <td th:text="${it.itemName}">항목명</td>
		        <td th:text="${it.itemType != null and it.itemType.name() == 'ALLOWANCE' ? '수당' : '공제'}">유형</td>
		        <td th:text="${it.calcType != null and it.calcType.name() == 'FIXED' ? '고정금액' : '비율'}">계산</td>
		        <td class="text-end"
		            th:text="${it.amount != null ? #numbers.formatDecimal(it.amount, 0, 'COMMA', 0, 'POINT') : '-'}">-</td>
		        <td class="text-end"
		            th:text="${it.rate != null ? #numbers.formatDecimal(it.rate, 1, 'POINT', 4, 'POINT') : '-'}">-</td>
		      </tr>
		      </tbody>
		    </table>
		  </div>

		  <div class="text-muted small mt-2">
		    선택한 항목만 반영되어 급여가 계산됩니다
		  </div>
		</div>
		
        <div class="d-flex gap-2">
          <button type="submit" class="btn btn-primary">저장</button>
          <a th:href="@{/payroll}" class="btn btn-outline-secondary">취소</a>
        </div>

      </form>

    </div>
  </div>

</section>
</body>
</html>
