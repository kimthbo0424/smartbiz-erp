<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
      th:replace="~{base :: layout(~{::section})}">
<body>
<section>

<h2 class="fw-bold mb-4">ìƒí’ˆ ìƒì„¸ ì •ë³´</h2>

<div class="card shadow-sm p-4">

    <div class="mb-3"><strong>ìƒí’ˆëª…:</strong> <span id="name"></span></div>
    <div class="mb-3"><strong>SKU:</strong> <span id="sku"></span></div>
    <div class="mb-3"><strong>ë°”ì½”ë“œ:</strong> <span id="barcode"></span></div>
    <div class="mb-3"><strong>ì¹´í…Œê³ ë¦¬:</strong> <span id="category"></span></div>
    <div class="mb-3"><strong>ë‹¨ê°€:</strong> <span id="unitPrice"></span></div>
    <div class="mb-3"><strong>ì›ê°€:</strong> <span id="costPrice"></span></div>
    <div class="mb-3"><strong>ìƒíƒœ:</strong> <span id="status"></span></div>
    <div class="mb-3"><strong>í™œì„±í™” ì—¬ë¶€:</strong> <span id="active"></span></div>

    <!-- ğŸ”¹ ê³µê¸‰ì‚¬ ê´€ë¦¬ ì˜ì—­ -->
    <div class="mt-4 p-3 border rounded bg-light">
        <div class="d-flex justify-content-between align-items-center">
            <strong>ê³µê¸‰ì‚¬ ê´€ë¦¬</strong>
            <a id="supplierManageBtn"
               class="btn btn-sm btn-outline-primary">
                ê³µê¸‰ì‚¬ ëª©ë¡ ë³´ê¸°
            </a>
        </div>
        <small class="text-muted">
            ì´ ìƒí’ˆì— ë“±ë¡ëœ ê³µê¸‰ì‚¬ ëª©ë¡ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.
        </small>
    </div>

    <div class="d-flex justify-content-between mt-4">
        <a href="/product/list" class="btn btn-secondary">ëª©ë¡</a>
        <div>
            <a id="editBtn" class="btn btn-warning me-2">ìˆ˜ì •</a>
            <button class="btn btn-danger" onclick="deleteProduct()">ì‚­ì œ</button>
        </div>
    </div>
</div>

<script>
const productId = location.pathname.split("/").pop();

document.addEventListener("DOMContentLoaded", loadProduct);

async function loadProduct() {
    const res = await fetch(`/api/products/${productId}`);
    const result = await res.json();
    const p = result.data;

    document.getElementById("name").innerText = p.name ?? "(ì—†ìŒ)";
    document.getElementById("sku").innerText = p.sku;
    document.getElementById("barcode").innerText = p.barcode ?? "-";
    document.getElementById("category").innerText = p.categoryName ?? "-";
    document.getElementById("unitPrice").innerText = p.unitPrice ?? "-";
    document.getElementById("costPrice").innerText = p.costPrice ?? "-";
    document.getElementById("status").innerText = p.status;
    document.getElementById("active").innerText = p.isActive ? "í™œì„±" : "ë¹„í™œì„±";

    // ìˆ˜ì • ë²„íŠ¼
    document.getElementById("editBtn").href = `/product/edit/${p.id}`;

    // ê³µê¸‰ì‚¬ ê´€ë¦¬ ë²„íŠ¼ (MVC)
    document.getElementById("supplierManageBtn").href =
        `/product-supplier/product/${p.id}`;
}

async function deleteProduct() {
    if (!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;

    const res = await fetch(`/api/products/${productId}`, { method: "DELETE" });

    if (res.ok) {
        alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
        location.href = "/product/list";
    } else {
        alert("ì‚­ì œ ì‹¤íŒ¨");
    }
}
</script>

</section>
</body>
</html>
