<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
      th:replace="~{base :: layout(~{::section})}">
<body>
<section class="d-flex justify-content-left">
  <div class="w-100" style="max-width: 900px;">

    <div class="d-flex align-items-center mb-3">
      <h2 class="fw-bold me-auto">직원 등록 수정</h2>
      <a th:href="@{/employees}" class="btn btn-outline-secondary btn-sm">목록으로</a>
    </div>

    <div class="card shadow-sm p-4">
      <form th:action="@{/employee/save}" th:object="${employee}" th:with="readonlyUser=${session.auth != null and session.auth > 2}" method="post">

        <input type="hidden" th:field="*{employeeId}">

        <div th:if="${error != null && !#strings.isEmpty(error)}"
             class="alert alert-danger py-2 mb-3"
             th:text="${error}">
        </div>

        <div class="row g-4">

          <div class="col-md-4">
            <label class="form-label fw-semibold">이름</label>
            <input th:field="*{name}" class="form-control form-control-sm" th:readonly="${readonlyUser}">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">주민등록번호</label>
            <input th:field="*{jumin}" th:readonly="${readonlyUser}" class="form-control form-control-sm"
                   placeholder="없이 작성" maxlength="13" required>
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">부서</label>
            <select th:field="*{deptId}" th:disabled="${readonlyUser}" class="form-select form-select-sm">
              <option th:each="d : ${departments}"
                      th:value="${d.deptId}"
                      th:text="${d.name}">
              </option>
            </select>
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">직급</label>
            <select th:field="*{rankId}" th:disabled="${readonlyUser}" class="form-select form-select-sm">
              <option th:each="r : ${ranks}"
                      th:value="${r.positionId}"
                      th:text="${r.name}">
              </option>
            </select>
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">직책</label>
            <select th:field="*{titleId}" th:disabled="${readonlyUser}" class="form-select form-select-sm">
              <option value="">없음</option>
              <option th:each="t : ${titles}"
                      th:value="${t.positionId}"
                      th:text="${t.name}">
              </option>
            </select>
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">입사일</label>
			<input type="date"
			       class="form-control"
			       name="hireDate"
				   th:readonly="${readonlyUser}"
			       th:value="${employee.hireDate != null ? #temporals.format(employee.hireDate, 'yyyy-MM-dd') : ''}">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">퇴사일</label>
            <input th:field="*{retireDate}" th:readonly="${readonlyUser}" type="date" class="form-control form-control-sm">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">상태</label>
            <select th:field="*{status}" th:disabled="${readonlyUser}" class="form-select form-select-sm">
              <option value="재직">재직</option>
              <option value="휴직">휴직</option>
              <option value="퇴사">퇴사</option>
            </select>
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">전화번호</label>
            <input th:field="*{phone}" th:readonly="${readonlyUser}" class="form-control form-control-sm">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">이메일</label>
            <input th:field="*{email}" th:readonly="${readonlyUser}" type="email" class="form-control form-control-sm">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">주소</label>
            <input th:field="*{address}" th:readonly="${readonlyUser}" class="form-control form-control-sm">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">기본급</label>
            <input th:field="*{baseSalary}" th:readonly="${readonlyUser}" type="number" class="form-control form-control-sm" min="0">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">은행명</label>
            <input th:field="*{bankName}" th:readonly="${readonlyUser}" class="form-control form-control-sm">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">계좌번호</label>
            <input th:field="*{bankAccount}" th:readonly="${readonlyUser}" class="form-control form-control-sm">
          </div>

          <div class="col-12">
            <hr class="my-2">
            <div class="fw-bold mb-2">계정 정보</div>
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">로그인 아이디</label>
            <input th:field="*{loginId}" th:readonly="${readonlyUser}" class="form-control form-control-sm">
          </div>

          <div class="col-md-4">
            <label class="form-label fw-semibold">비밀번호</label>
            <input th:field="*{password}" type="password" class="form-control form-control-sm"
                   placeholder="신규 또는 변경 시에만 입력">
            <div class="form-text">
              수정 화면에서는 비밀번호를 비우면 기존 비밀번호 유지
            </div>
          </div>

          <div class="col-md-2">
            <label class="form-label fw-semibold">권한</label>
            <select th:field="*{auth}" th:disabled="${readonlyUser}" class="form-select form-select-sm">
              <option value="1">ADMIN</option>
              <option value="2">HR</option>
              <option value="3">USER</option>
            </select>
          </div>

          <div class="col-md-2">
            <label class="form-label fw-semibold">사용여부</label>
            <select th:field="*{useYn}" th:disabled="${readonlyUser}" class="form-select form-select-sm">
              <option value="Y">Y</option>
              <option value="N">N</option>
            </select>
          </div>

        </div>

        <div class="mt-4 text-end">
          <a th:href="@{/employees}" class="btn btn-secondary btn-sm me-2">취소</a>
          <button class="btn btn-primary btn-sm" type="submit">저장</button>
        </div>

      </form>
    </div>

  </div>
</section>
</body>
</html>
